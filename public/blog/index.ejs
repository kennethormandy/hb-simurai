<% function excerpt(content) {
  if(!content || content.indexOf("</p>") == -1) return;
  else return content.split("<p>")[1].split("</p>")[0];
} %>

<ul class="index">
  <% for(var slug in public.blog._data){ %>
    <% var post = public.blog._data[slug] %>
    <% if(post.title) { %>
      <li class="index-item">
        <a class="index-link" href="<%= slug %>">
          <h2 class="index-title">
            <%= post.title %>
          </h2>
          <time class="time time--inline"><%= post.date %></time>
          <% if(post.author) { %><span class="meta-author">by <a href="http://twitter.com/<%= authors[post.author].twitter %>"><%= authors[post.author].name %></a></span><% } %>
        </a>
        <p><%- excerpt(partial(slug)) %></p>
        <a class="index-more" href="">•••</a>
      </li>
    <% } %>
  <% } %>
</ul>
